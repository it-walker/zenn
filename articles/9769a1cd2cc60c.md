---
title: "MySqlã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰å¤‰æ›´"
emoji: "ğŸ˜Š"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["mysql", "docker"]
published: true
---

## ç¾çŠ¶ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰çŠ¶æ…‹ã‚’ç¢ºèªã—ã¦ã¿ã‚‹

```
show variables like "chara%";
```

ç¾åœ¨ã®çŠ¶æ…‹ã¯ã“ã†ãªã£ã¦ã„ã‚‹æ¨¡æ§˜ã€‚

| Variable_name | Value |
| --- | --- |
|character_set_client | utf8mb4 |
|character_set_connection | utf8mb4 |
|character_set_database | latin1 |
|character_set_filesystem | binary |
|character_set_results | utf8mb4 |
|character_set_server | latin1 |
|character_set_system | utf8 |
|character_sets_dir | /usr/share/mysql/charsets/ |

## utf-8ã¨utf8mb4ã®é•ã„ã£ã¦ï¼Ÿ

çµè«–ã‹ã‚‰è¨€ã†ã¨ã€utf8mb4ã‚’ä½¿ç”¨ã—ã¦ã„ãæ–¹ãŒè‰¯ã•ãã†ã€‚ã€‚

MySqlã®utf8ã¯1ã€œ3ãƒã‚¤ãƒˆã¾ã§ã—ã‹æ‰±ãˆãªã„ã‚“ã§ã™ã£ã¦ã€‚


## Mysqlã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã™ã‚‹
ã¾ãšã¯ã€ä½¿ç”¨ã—ã¦ã„ã‚‹MySqlã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ç¢ºèªã—ã¦ã¿ã‚‹ã€‚

```
select version();
â†’5.7.36
```

## å„è¨­å®šã®æ„å‘³ã‚’ç¢ºèª

| Variable_name | description |
| --- | --- |
|character_set_client | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãŒé€ã£ã¦ãã‚‹ã¨ã‚µãƒ¼ãƒãƒ¼ãŒæƒ³å®šã—ã¦ã„ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ |
|character_set_connection | ã‚¯ã‚¨ãƒªã‚’å®Ÿè¡Œã™ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ |
|character_set_database | ä½¿ã£ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã€‚å¤‰ãˆã‚‹å¿…è¦ã¯ãªã„ã—setã§å¤‰ãˆã¦ã¯ã„ã‘ãªã„|
|character_set_filesystem | ãƒ•ã‚¡ã‚¤ãƒ«åã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã„ã„|
|character_set_results | ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã«çµæœã‚’è¿”ã™ã¨ãã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ |
|character_set_server | æ–°è¦ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œã‚‹ã¨ãã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ã€‚è¨­å®šã—ã¦ãŠãã¨æ¥½ã€‚ã„ã‚ã„ã‚ç¶™æ‰¿ã•ã‚Œã‚‹ãŒä¸Šæ›¸ãã§ãã‚‹ã€‚ |
|character_set_system | ã‚µãƒ¼ãƒãƒ¼ãŒè­˜åˆ¥å­ã‚’æ ¼ç´ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹æ–‡å­—ã‚»ãƒƒãƒˆ |
|character_sets_dir | ãƒ†ãƒ¼ãƒ–ãƒ«åã¨ã‹ã‚’ä¿å­˜ã™ã‚‹æ–‡å­—ã‚³ãƒ¼ãƒ‰ã€‚ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã„ã„ |


## è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«

ä¸‹è¨˜ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆmy.cnfï¼‰ã‚’ä½œæˆã™ã‚‹ã€‚

```ini
[mysqld]
character-set-server=utf8mb4

[client]
default-character-set=utf8mb4
```

## docker-compose.yml

docker-compose.ymlã®ã‚³ãƒ³ãƒ†ãƒŠã®volumesã«ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ã€‚

```yml
version: '3'
services:
  db_data:
    image: busybox
    volumes:
      - type: bind
        source: "./db/conf.d/my.cnf"
        target: "/etc/mysql/conf.d/my.cnf"
```

## ã“ã‚Œã§OKã‹ã¨æ€ã£ãŸã‚‰ã€‚ã€‚

ã™ã§ã«ä½œæˆæ¸ˆã¿ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¤ã„ã¦ã¯ã€æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒå¤‰æ›´ã—ã¦ãã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚
ä»Šå›ã¯å‹‰å¼·ç”¨ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãªã®ã§ã€ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤â†’å†ä½œæˆã™ã‚‹ã“ã¨ã§ã€DBã‚’ä¸€ã‹ã‚‰æ§‹ç¯‰ã—ç›´ã—ã¾ã—ãŸã€‚
ä¸€åº¦dropã—ã¦createã—ã¦ã—ã¾ãˆã°å•é¡Œãªã—ã§ã—ãŸã€‚

æœ€çµ‚çš„ã«ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

| Variable_name | Value |
| --- | --- |
|character_set_client | utf8mb4 |
|character_set_connection | utf8mb4 |
|character_set_database | utf8mb4 |
|character_set_filesystem | binary |
|character_set_results | utf8mb4 |
|character_set_server | utf8mb4 |
|character_set_system | utf8 |
|character_sets_dir | /usr/share/mysql/charsets/ |


## å‚è€ƒè³‡æ–™
https://penpen-dev.com/blog/mysql-utf8-utf8mb4/